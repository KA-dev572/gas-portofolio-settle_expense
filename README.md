# gas-portofolio-settle_expense
1 概要
経費精算申請用Googleフォームに入力すると経費の仕訳台帳（スプレッドシート）へ自動転記するスクリプト

2 想定業務
従業員が経費（旅費交通費、接待交際費等）を立替払いした時の仕訳
オプションで精算申請があった場合に経理担当者にメール通知も可

3 使用技術
- Google Apps Script
- Google Spreadsheet
- Google Forms
- GmailApp(option)

4 工夫した点
Google フォームの入力側で金額入力欄を自然数に限定するなど、ヒューマンエラーによる作動停止が極力生じないようにした。
出力先の列が入れ替わっても作動するようindexOfを用いた列管理を行った。

5 課題・改善の余地
setValuesなどAPI呼び出し回数は減らすことができる。
エラー対策を正確に。

## 動作環境
- Google Spreadsheet
  - 出力先シート構成：A列以降に連続して次の各列を含む
   - 日付, 借方科目,	借方金額,	貸方科目,	貸方金額,	摘要, 社員名
- Google Forms: 入力元。次の順で質問
  - 氏名, 立替日, 勘定科目, 立替金額（円）, 摘要（目的、相手方、場所等）, 添付書類

## 導入手順（簡略）
1. 新規Googleフォームを作成
2. 回答（申請内容）をまとめるスプレッドシートにコンテナバインドしたApps Scriptに本リポジトリのコードを貼り付け
3. 利用環境依存部分（メールアドレス、出力先スプレッドシートID等）を適宜変更
4. トリガー（フォーム申請）を設定

## 公開にあたって
本リポジトリに含まれるコードは学習・ポートフォリオ目的で公開しています。  
実運用に関わるID・メールアドレス・データはすべてダミーに置き換えています。
